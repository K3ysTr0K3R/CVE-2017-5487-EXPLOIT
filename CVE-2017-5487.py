#!/bin/python3

import json
import requests
import argparse

my_parser = argparse.ArgumentParser(description='')
my_parser.add_argument('-u', '--url', type=str, help='')
args = my_parser.parse_args()
target = args.url

find_wordpress = requests.get(f"{target}").text
if "wp-content" in find_wordpress:
    # The path to the Rest API.
    path = "/wp-json/wp/v2/users"
    url = f"{target}" + path
    response_code = requests.get(url).status_code
    if response_code == 200: # If /wp-json/wp/v2/users is found then complete enumeration.
        # Send GET request to the URL to retrieve the response.
        send_get = requests.get(url).text
        # Store json format from API and convert it to readable format.
        json_format = json.loads(send_get)
        print("-----------------------")
        print("    WordPress USERS    ")
        print("-----------------------")
        for users in json_format:
            print("[+]", users['slug']) # Usernames from json format (slug).
        print("-----------------------")
    else:
        print("No Users")
        exit()
else:
    print("No Users")
    exit()
